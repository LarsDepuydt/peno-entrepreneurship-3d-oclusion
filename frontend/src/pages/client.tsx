import { sendVR } from '@/gen/proto/threedoclusion/v1/service-ScanService_connectquery'
import { useQuery } from '@tanstack/react-query';
import { useState } from 'react';


export default function ClientPage() {
    let scanId = 111 // Should be generated by clicking on certain scan
    const [clientId, setClientId] = useState<number | undefined>(undefined);
    const [submitOK, setSubmitOK] = useState(false);
    const [tempValue, setTempValue] = useState(0);

    const {data, refetch} = useQuery(sendVR.useQuery({ clientId, scanId }));

    function afterSubmit(event: React.FormEvent<HTMLFormElement>) {
      event.preventDefault();
      let codeInput = document.getElementById("code") as HTMLInputElement | null;
  
      if (codeInput){
        setTempValue(parseInt(codeInput.value, 10));
      }
    }

    const handleRedirect = () => {
        setClientId(tempValue); // Temporary solution
    };

  return (
    <div>
      <h1>Client Page</h1>
      <form onSubmit={afterSubmit}>
        Code: <input type="text" id="code" size={20} name="code"/><br/>
        <input type="submit" value="Submit"/> 
      </form>
      <button id="redirect-button" onClick={handleRedirect}>Send to VR</button>
    </div>
  )
}